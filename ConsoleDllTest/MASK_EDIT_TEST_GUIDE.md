# ğŸ¨ Mask äº¤äº’ç¼–è¾‘åŠŸèƒ½æµ‹è¯•æŒ‡å—

## ğŸ“‹ æµ‹è¯•æ­¥éª¤

### 1ï¸âƒ£ ç¼–è¯‘é¡¹ç›®
```bash
cd "D:\2025-09-25 æ–°ç³»åˆ—\ConsoleDllTest"
msbuild ConsoleDllTest.sln /p:Configuration=Debug /p:Platform=x64
```

### 2ï¸âƒ£ è¿è¡Œæ§åˆ¶å°ç¨‹åº
```bash
cd "Dlls\debug\bin"
ConsoleDllTest.exe
```

### 3ï¸âƒ£ è¾“å…¥æµ‹è¯•å‘½ä»¤
```
Enter command (type 'help' for options): mask-edit
```

## ğŸ® æ“ä½œæŒ‡å—

### **çª—å£æ‰“å¼€åï¼Œä½ ä¼šçœ‹åˆ°ï¼š**
- **ç™½è‰²åŠé€æ˜è¦†ç›–å±‚** = Bone Maskï¼ˆä»é˜ˆå€¼è‡ªåŠ¨æå–çš„éª¨å¤´ï¼‰
- **ç»¿è‰²åŠé€æ˜è¦†ç›–å±‚** = Custom Maskï¼ˆç©ºç™½ï¼Œç”¨äºæ‰‹åŠ¨ç¼–è¾‘ï¼‰

---

## âŒ¨ï¸ é”®ç›˜å¿«æ·é”®

### ã€è§†å›¾æ§åˆ¶ã€‘
| æŒ‰é”® | åŠŸèƒ½ |
|------|------|
| **é¼ æ ‡æ»šè½®** | åˆ‡æ¢åˆ‡ç‰‡ï¼ˆå‘ä¸Š/å‘ä¸‹ï¼‰ |
| **Ctrl + æ»šè½®** | ç¼©æ”¾è§†å›¾ |
| **X** | åˆ‡æ¢åˆ° Axial è½´å‘é¢ï¼ˆXYå¹³é¢ï¼‰ |
| **Y** | åˆ‡æ¢åˆ° Coronal å† çŠ¶é¢ï¼ˆXZå¹³é¢ï¼‰ |
| **Z** | åˆ‡æ¢åˆ° Sagittal çŸ¢çŠ¶é¢ï¼ˆYZå¹³é¢ï¼‰ |

### ã€Mask ç¼–è¾‘æ¨¡å¼ã€‘
| æŒ‰é”® | åŠŸèƒ½ |
|------|------|
| **7** | â­ è¿›å…¥ Mask ç¼–è¾‘æ¨¡å¼ï¼ˆå¿…é¡»å…ˆæŒ‰è¿™ä¸ªï¼ï¼‰ |
| **B** | é€‰æ‹©ç”»ç¬”å·¥å…·ï¼ˆç»¿è‰²åœ†åœˆé¢„è§ˆï¼‰ |
| **E** | é€‰æ‹©æ©¡çš®æ“¦å·¥å…·ï¼ˆçº¢è‰²åœ†åœˆé¢„è§ˆï¼‰ |
| **[** | å‡å°ç”»ç¬”åŠå¾„ï¼ˆ-2pxï¼‰ |
| **]** | å¢å¤§ç”»ç¬”åŠå¾„ï¼ˆ+2pxï¼‰ |
| **Shift + [** | å¾®è°ƒå‡å°ï¼ˆ-0.5pxï¼‰ |
| **Shift + ]** | å¾®è°ƒå¢å¤§ï¼ˆ+0.5pxï¼‰ |

### ã€é¼ æ ‡æ“ä½œã€‘
| æ“ä½œ | åŠŸèƒ½ |
|------|------|
| **å·¦é”®æ‹–æ‹½** | ç»˜åˆ¶ï¼ˆç”»ç¬”æ¨¡å¼ï¼‰æˆ–æ“¦é™¤ï¼ˆæ©¡çš®æ“¦æ¨¡å¼ï¼‰ |
| **å³é”®** | å–æ¶ˆå½“å‰æ“ä½œ |

### ã€å…¶ä»–å·¥å…·ï¼ˆå‚è€ƒï¼‰ã€‘
| æŒ‰é”® | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| **R** | Rectangle ROI | ğŸ”œ å¾…å®ç° |
| **C** | Circle ROI | ğŸ”œ å¾…å®ç° |
| **P** | Polygon ROI | ğŸ”œ å¾…å®ç° |
| **F** | Flood Fill | ğŸ”œ å¾…å®ç° |
| **N** | Connected Component | ğŸ”œ å¾…å®ç° |

---

## ğŸ§ª å®Œæ•´æµ‹è¯•æµç¨‹

### **æ­¥éª¤1ï¼šå¯åŠ¨ç¨‹åº**
```
ConsoleDllTest.exe
Enter command: mask-edit
```

### **æ­¥éª¤2ï¼šç­‰å¾…åŠ è½½**
æ§åˆ¶å°è¾“å‡ºï¼š
```
[1/6] Loading DICOM volume...
âœ… Volume loaded: 512 x 512 x 133

[2/6] Creating MaskManager...
âœ… MaskManager created

[3/6] Creating masks...
  âœ… Mask #0: Bone (threshold 200-3000)
  âœ… Mask #1: Custom (for manual editing)

[4/6] Initializing visualization...
âœ… MPR window created (800x800)

[5/6] Adding mask overlays...
  âœ… Overlay #0: Bone (white)
  âœ… Overlay #1: Custom (green)

[6/6] Configuring edit tools...
  âœ… Current mask: #1 (Custom)
  âœ… Brush radius: 5.0 px

ğŸ¨ Rendering... Please operate the window!
```

### **æ­¥éª¤3ï¼šè¿›å…¥ç¼–è¾‘æ¨¡å¼**
1. æŒ‰ **7** é”®
   - æ§åˆ¶å°æ˜¾ç¤ºï¼š`[Tool] Switched to Tool 7 (Mask Edit Mode)`
   - æç¤ºï¼š`  B=Brush, E=Eraser, R/C/P/F/N=...`

### **æ­¥éª¤4ï¼šä½¿ç”¨ç”»ç¬”ç»˜åˆ¶**
1. æŒ‰ **B** é”®ï¼ˆé€‰æ‹©ç”»ç¬”ï¼‰
   - æ§åˆ¶å°æ˜¾ç¤ºï¼š`[Mask Tool] Switched to: Brush (radius: 5.0)`
   - é¼ æ ‡ç§»åŠ¨æ—¶ä¼šæ˜¾ç¤º**ç»¿è‰²åœ†åœˆé¢„è§ˆ**

2. **å·¦é”®æ‹–æ‹½**åœ¨ç»¿è‰² Mask ä¸Šç»˜åˆ¶
   - æ¯æ¬¡ç‚¹å‡»/æ‹–æ‹½æ§åˆ¶å°æ˜¾ç¤ºï¼š`[MPR Mask] Brush started`
   - æ¾å¼€é¼ æ ‡æ˜¾ç¤ºï¼š`[MPR Mask] Stopped Brush`

3. **æ»šè½®åˆ‡æ¢åˆ‡ç‰‡**æŸ¥çœ‹ä¸åŒå±‚çš„ç»˜åˆ¶

### **æ­¥éª¤5ï¼šä½¿ç”¨æ©¡çš®æ“¦**
1. æŒ‰ **E** é”®ï¼ˆåˆ‡æ¢åˆ°æ©¡çš®æ“¦ï¼‰
   - æ§åˆ¶å°æ˜¾ç¤ºï¼š`[Mask Tool] Switched to: Eraser (radius: 5.0)`
   - é¼ æ ‡ç§»åŠ¨æ—¶æ˜¾ç¤º**çº¢è‰²åœ†åœˆé¢„è§ˆ**

2. **å·¦é”®æ‹–æ‹½**æ“¦é™¤åˆšæ‰ç»˜åˆ¶çš„å†…å®¹

### **æ­¥éª¤6ï¼šè°ƒæ•´ç”»ç¬”å¤§å°**
1. æŒ‰ **]** é”®å¢å¤§ç”»ç¬”
   - æ§åˆ¶å°æ˜¾ç¤ºï¼š`[Brush] Radius adjusted to 7.0`
   - é¢„è§ˆåœ†åœˆå˜å¤§

2. æŒ‰ **[** é”®å‡å°ç”»ç¬”
   - æ§åˆ¶å°æ˜¾ç¤ºï¼š`[Brush] Radius adjusted to 5.0`

### **æ­¥éª¤7ï¼šåˆ‡æ¢è§†å›¾**
1. æŒ‰ **X** é”® â†’ Axial è½´å‘é¢ï¼ˆæ¨ªæ–­é¢ï¼‰
2. æŒ‰ **Y** é”® â†’ Coronal å† çŠ¶é¢ï¼ˆé»˜è®¤è§†å›¾ï¼‰
3. æŒ‰ **Z** é”® â†’ Sagittal çŸ¢çŠ¶é¢ï¼ˆä¾§é¢ï¼‰

### **æ­¥éª¤8ï¼šé€€å‡º**
- æŒ‰ **ESC** æˆ–å…³é—­çª—å£

---

## ğŸ› é¢„æœŸæ•ˆæœ

### âœ… **æ­£å¸¸ç°è±¡ï¼š**
1. çœ‹åˆ°ä¸¤å±‚åŠé€æ˜è¦†ç›–ï¼š
   - **ç™½è‰²** = Bone Maskï¼ˆéª¨å¤´è½®å»“ï¼‰
   - **ç»¿è‰²** = Custom Maskï¼ˆç©ºç™½æˆ–ä½ ç»˜åˆ¶çš„å†…å®¹ï¼‰

2. è¿›å…¥ç¼–è¾‘æ¨¡å¼åï¼š
   - ç”»ç¬”ï¼ˆBï¼‰ï¼šç»¿è‰²åœ†åœˆè·Ÿéšé¼ æ ‡
   - æ©¡çš®æ“¦ï¼ˆEï¼‰ï¼šçº¢è‰²åœ†åœˆè·Ÿéšé¼ æ ‡

3. ç»˜åˆ¶æ—¶ï¼š
   - å·¦é”®æ‹–æ‹½åœ¨ç»¿è‰² Mask ä¸Šæ·»åŠ åƒç´ 
   - åˆ‡æ¢åˆ‡ç‰‡åï¼Œæ¯å±‚ç‹¬ç«‹ç¼–è¾‘

4. æ“¦é™¤æ—¶ï¼š
   - å·¦é”®æ‹–æ‹½åˆ é™¤ç»¿è‰² Mask åƒç´ 

### âŒ **å¼‚å¸¸æƒ…å†µæ’æŸ¥ï¼š**

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ³• |
|------|----------|----------|
| çª—å£æ‰“ä¸å¼€ | DICOM è·¯å¾„é”™è¯¯ | æ£€æŸ¥ `D:\Scripts\Example\è‚ºéƒ¨` æ˜¯å¦å­˜åœ¨ |
| æ²¡æœ‰ç»¿è‰²é¢„è§ˆåœ†åœˆ | æœªè¿›å…¥ç¼–è¾‘æ¨¡å¼ | å…ˆæŒ‰ **7** é”®ï¼ |
| ç”»ç¬”ä¸èµ·ä½œç”¨ | æœªé€‰æ‹©ç”»ç¬”å·¥å…· | æŒ‰ **B** é”® |
| çœ‹ä¸åˆ° Mask | Mask å åŠ æœªæ·»åŠ  | æ£€æŸ¥æ­¥éª¤5æ§åˆ¶å°è¾“å‡º |
| ç¼–è¯‘é”™è¯¯ | DLL æœªæ›´æ–° | é‡æ–°ç¼–è¯‘ DllVisualization |

---

## ğŸ“Š æ§åˆ¶å°æ—¥å¿—å‚è€ƒ

### **æ­£å¸¸æ—¥å¿—ç¤ºä¾‹ï¼š**
```
[1/6] Loading DICOM volume...
âœ… Volume loaded: 512 x 512 x 133

[6/6] Configuring edit tools...
  âœ… Current mask: #1 (Custom)
  âœ… Brush radius: 5.0 px

ğŸ¨ Rendering... Please operate the window!

[æŒ‰ 7]
[Tool] Switched to Tool 7 (Mask Edit Mode)
  Sub-tools: B=Brush, E=Eraser, R/C/P/F/N=...

[æŒ‰ B]
[Mask Tool] Switched to: Brush (radius: 5.0)

[å·¦é”®ç‚¹å‡»]
[MPR Mask] Brush started at slice 66

[å·¦é”®é‡Šæ”¾]
[MPR Mask] Stopped Brush

[æŒ‰ ]]
[Brush] Radius adjusted to 7.0

[æŒ‰ E]
[Mask Tool] Switched to: Eraser (radius: 7.0)
```

---

## ğŸ¯ æµ‹è¯•è¦ç‚¹

### **å¿…é¡»éªŒè¯çš„åŠŸèƒ½ï¼š**
- [x] Mask æ˜¾ç¤ºï¼ˆç™½è‰²éª¨å¤´ + ç»¿è‰²è‡ªå®šä¹‰ï¼‰
- [x] å·¥å…·åˆ‡æ¢ï¼ˆ7è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼ŒB/Eåˆ‡æ¢ç”»ç¬”æ©¡çš®æ“¦ï¼‰
- [x] ç”»ç¬”é¢„è§ˆï¼ˆç»¿è‰²/çº¢è‰²åœ†åœˆè·Ÿéšé¼ æ ‡ï¼‰
- [x] ç»˜åˆ¶åŠŸèƒ½ï¼ˆå·¦é”®æ‹–æ‹½æ·»åŠ åƒç´ ï¼‰
- [x] æ“¦é™¤åŠŸèƒ½ï¼ˆå·¦é”®æ‹–æ‹½åˆ é™¤åƒç´ ï¼‰
- [x] ç”»ç¬”å¤§å°è°ƒæ•´ï¼ˆ[ ] é”®ï¼‰
- [x] åˆ‡ç‰‡å¯¼èˆªï¼ˆæ»šè½®ï¼‰
- [x] è§†å›¾åˆ‡æ¢ï¼ˆX/Y/Zï¼‰

### **å¯é€‰æµ‹è¯•ï¼š**
- [ ] ç¼©æ”¾åŠŸèƒ½ï¼ˆCtrl+æ»šè½®ï¼‰
- [ ] å¤šå±‚ç¼–è¾‘ï¼ˆæ¯ä¸ªåˆ‡ç‰‡ç‹¬ç«‹ï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆå¤§èŒƒå›´ç»˜åˆ¶æ˜¯å¦æµç•…ï¼‰

---

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. **æ§åˆ¶å°å®Œæ•´æ—¥å¿—**
2. **æŒ‰é”®æ“ä½œé¡ºåº**
3. **é¢„æœŸæ•ˆæœ vs å®é™…æ•ˆæœ**
4. **æˆªå›¾ï¼ˆå¦‚æœæœ‰ï¼‰**

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼ğŸ‰**
